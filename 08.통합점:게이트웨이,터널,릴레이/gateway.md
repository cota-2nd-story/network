# 게이트웨이

> 게이트웨이를 공부하면서 여러 샛길로 많이 빠져버렸다...

### 인터넷 접속 과정

사람들은 무선 디바이스를 와이파이에 연결하기 위해 AP와 통신을 주고 받는다. 

- AP (Access Point) : wireless access point라 하는 무선 엑세스 포인트는 무선 장치와 유선 장치에 연결할 수 있게 하는 장치를 가리킨다. (오래전부터 사람들은 유선보다 무선을 더 선호한다. 같은 맥락(?)에서 AP 또한 무선으로 연결되는 장치가 대부분이다. ) 흔히 WAP는 유선망을 거치게되는 라우터에 연결된다. LAN의 endpoint라 할 수 있는 라우터는 로컬 네트워크상에서 여러 디바이스와 WAP를 통해 무선으로 연결되고 LAN을 벗어나면서 유선으로 이어진다. 컴퓨터, 프린터와 같은 무선 장치와 유선 장치 간 데이터를 중계할 수 있다.

이렇게 AP는 스위치와 연결된다.

- 스위치 : 네트워크 데이터 단위들을 연결하는 통신장비를 가리킨다. 스위치는 허브와 비슷하지만 훨씬 빠른 네트워크 속도를 제공한다. 허브는 데이터조각을 연결된 모든 컴퓨터에 전송하지만(매우 비효율적) 스위치는 데이터를 필요로하는 컴퓨터에게만 전송한다. 이는 병목 현상이 쉽게 생기지 않게 하며 동시 전이중 통신 방식을 제공하기 때문에 송신과 수신이 동시에 일어나는 경우 더 빠른 네트워크 속도를 제공할 수 있게 된다.

스위치는 라우터와 연결되어 있으며 라우터는 통신사에서 제공하는 ISP의 네트워크에 연결된다.

- 라우터 : 라우팅 기능을 갖는 공유기인 이 기기는 패킷의 전달되어야하는 최적의 경로를 지정하며 경로를 따라 데이터 패킷이 다음 장치로 전향(forwarding)시키는 장치다. 라우터는 서로 다른 네트워크 간에 중계 역할을 해준다. 경로 설정 기능(routing), 패킷 스위칭 기능(forwarding)을 통해 각기 다른 네트워크를 연결시켜준다.
- ISP(Internet Service Provider) : 여러 사용자들이 인터넷을 사용할 수 있게 네트워크 접속을 도와주는 서비스 혹은 장치를 말한다.

이렇게 라우터를 통해 LAN을 벗어나게되는데 동시에 필요한 장치가 게이트웨이다.

- 게이트웨이 : 서로 다른 통신망, 프로토콜을 사용하는 네트워크간의 통신을 가능케해주는 장치를 말한다. 기본적으로 서로 다른 네트워크의 노드(컴퓨터)가 연결되려면 같은 통신 프로토콜을 사용해야한다. 따라서 네트워크가 망을 이루면서 여러 단계를 거치면서 통신을 하게 되는데 그때마다 사용되는 프로토콜은 다르기에 이를 적절히 맞춰줘야하는 중간단계의 무엇이 필요하다. 게이트웨이가 그 역할을 수행한다.

사실 게이트웨이도 하나의 라우터라고 볼 수 있다. 라우터가 패킷을 보내야하는 네트워크를 결정함으로써 두 네트워크를 연결한다는 점에서 게이트웨이의 역할과 상통한다. 공유가 우리가 흔히 접할 수 있는 첫번째 게이트웨이다.  사용자가 연결한 LAN의 통신 프로토콜(netbios)과 인터넷의 통신 프로토콜(http)이 다르기에 공유기가 이를 연결해주는다. 앞서 설명한 게이트웨이의 역할을 십분 발휘하고 있다고 볼 수 있다.

참고로 공유기는 게이트웨이, 라우터, 방화벽 역할 등을 동시에 제공하는 종합 네트워크 장비다.

LAN의 IP 주소와 서브넷마스크만 있어도 주변 컴퓨터와 통신이 가능하다. 스위치(허브)로 충분히 두개 이상의 컴퓨터를 연결할 수 있기 때문이다. 같은 네트워크 상이기 때문에 굳이 그 외부의 네트워크로 나갈 필요가 없기 때문이다. 하지만 지구반대편에 있는 LAN으로 연결하기 위해서는 현재 속한 LAN을 벗어나 인터넷에 연결되어야하는데 이를 가능케하는 것이 게이트웨이(라우터)라고 할 수 있다.

같은 LAN에서도 서로 다른 IP 주소를 할당하기에 (서로 통신을 위해서라면 유일한 주소값을 가지고 있어야하기 때문) 게이트웨이에도 중복되지 않는 IP주소 값이 필요하다. (일반적으로 게이트웨이의 IP 주소는 LAN에서 할당한 IP주소의 끝자리만 다른 형태, 흔히 1을 가진다. 예를 들어 특정 컴퓨터에 123.123.123.123 IP 주소가 할당됐다면 그 LAN에 연결된 게이트웨이는 123.123.123.1이 된다.

### 내 컴퓨터에서 게이트웨이 확인하기

- 내 IP 주소 확인하기

<img width="214" alt="스크린샷 2020-03-18 오후 11 13 00" src="https://user-images.githubusercontent.com/30451129/76973415-3e8ffa00-6973-11ea-9067-25cef23b4fb1.png">

- 내 라우터(게이트웨이) 확인하기

<img width="574" alt="스크린샷 2020-03-18 오후 11 13 58" src="https://user-images.githubusercontent.com/30451129/76973420-42238100-6973-11ea-9d59-a099b8fe0736.png">

공유기가 없다면 ISP의 네트워크에 연결된 게이트웨이(라우터) 주소가 지정됐을 것이다.

현재 내 로컬 네트워크에 연결된 IP 주소는 172.xx.xx.8 이다. 같은 LAN에 속해있는 컴퓨터들은 내 컴퓨터에 데이터를 전송하기 위해 172.xx.xx.8을 목적지로 설정하여 보내면 되는 것이다. 그런데 만약 브라우저를 통해 구글 사이트를 접속해야한다면 LAN내에는 구글 사이트에 대한 정보(브라우저에 뿌려줄 데이터)가 없기 때문에 LAN을 벗어나 인터넷을 통해 구글 서버까지 가야한다. 그때 나가는 관문이 172.xx.xx.1 주소의 게이트웨이다. 172.xx.xx.1 주소로 연결된 장치로간다면 우리는 LAN의 밖을 나갈 준비가 된 것이고 그 장치(게이트웨키 혹은 라우터, 또는 이를 아우르는 공유기)는 다음의 가야하는 네트워크 목적지를 제공한다. 그렇게 한다리, 한다리 건너 건너서 지구 반대변 구글 회사의 서버가 올라가 있는 네트워크까지 도달할 수 있을 것이다.

### 게이트웨이를 통해 LAN을 벗어나 목적지(구글)까지 도달하는데 거쳐간 홉 정보 확인하기

<img width="552" alt="스크린샷 2020-03-18 오후 11 32 12" src="https://user-images.githubusercontent.com/30451129/76973425-4485db00-6973-11ea-897d-ff7de9bf3bce.png">

현재 내 컴퓨터에 연결된 네트워크의 게이트웨이 주소 172.xx.xx.1을 통해 다음 네트워크의 라우터들을 거쳐가 11 홉만에 목적지에 도착하고 있다는 것을 확인할 수 있다. 중간에 * 표시는 보안을 위해 설정해놓은 거라 알고 있다.

reference

- [https://parksb.github.io/article/36.html?fbclid=IwAR15UeD4WM0Z0TZ4TTjjKGIfR3qnQiXPdEKWh73_2uPaSP12Qi51QjSm-Dw](https://parksb.github.io/article/36.html?fbclid=IwAR15UeD4WM0Z0TZ4TTjjKGIfR3qnQiXPdEKWh73_2uPaSP12Qi51QjSm-Dw)
- [https://it.donga.com/6744/](https://it.donga.com/6744/)
